@page "/profile"


@using System.Text.RegularExpressions
@using System.ComponentModel.DataAnnotations
@using PortfolioEye.Client.Extensions

<MudText Typo="Typo.h5" Color="Color.Primary" Class="mb-4">Account</MudText>
<MudTabs Elevation="25" Color="Color.Transparent" Rounded="true" PanelClass="mt-6">
	<MudTabPanel Text="Dane podstawowe">
		<MudGrid>
			<MudItem xs="12" sm="4" md="3">
				<MudCard Elevation="25">
					<MudCardHeader>
						<CardHeaderContent>
							<MudText>Zdjęcie</MudText>
						</CardHeaderContent>
					</MudCardHeader>
					<MudCardContent>
						<div class="d-flex justify-center mb-4">
							<MudAvatar Image="@AvatarImageLink" Style="height:100px; width:100px;">
								@if (AvatarImageLink == null)
								{
									@State.User.Identity?.GetInitials()
								}
							</MudAvatar>

						</div>
					</MudCardContent>
					<MudCardActions Class="d-flex justify-center">
						@if (AvatarImageLink == null)
						{
							<MudFileUpload T="IBrowserFile" FilesChanged="UploadFiles">
								<ButtonTemplate>
									<MudButton HtmlTag="label"
											   Color="Color.Primary"
											   StartIcon="@Icons.Material.Filled.CloudUpload"
											   for="@context.Id">
										Dodaj zdjęcie
									</MudButton>
								</ButtonTemplate>
							</MudFileUpload>
						}
						else
						{
							<MudButton OnClick="DeletePicture" Color="Color.Error">Usuń zdjęcie</MudButton>
						}
					</MudCardActions>
				</MudCard>
			</MudItem>
			<MudItem xs="12" sm="8" md="9">
				<MudCard Elevation="25">
					<MudCardHeader>
						<CardHeaderContent>
							<MudText>Szczegóły profilu</MudText>
						</CardHeaderContent>
					</MudCardHeader>
					<MudCardContent>
						<MudGrid>
							<MudItem xs="12" md="6">
								<MudTextField @bind-Value="FirstName" Label="First Name" Variant="Variant.Outlined" />
							</MudItem>
							<MudItem xs="12" md="6">
								<MudTextField @bind-Value="LastName" Label="First Name" Variant="Variant.Outlined" />
							</MudItem>
							<MudItem xs="12" md="6">
								<MudTextField @bind-Value="JobTitle" Label="Job Title" Variant="Variant.Outlined" />
							</MudItem>
							<MudItem xs="12" md="6">
								<MudTextField @bind-Value="Email" Label="Email" Variant="Variant.Outlined" HelperText="Dont worry, we shall not spam!" InputType="InputType.Email" />
							</MudItem>
							<MudItem xs="12">
								<MudText>
									<b>Visible Only To Friends</b>
								</MudText>
								<MudText Typo="Typo.body2">
									Means that only your friends will be able to see your contact details.
								</MudText>
								<MudSwitch @bind-Checked="@FriendSwitch" Color="Color.Secondary" />
							</MudItem>
						</MudGrid>
					</MudCardContent>
					<MudCardActions Class="pb-4 pl-4">
						<MudButton Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto" @onclick="@(() => SaveChanges("Profile details saved", Severity.Success))">Save Changes</MudButton>
					</MudCardActions>
				</MudCard>
			</MudItem>
		</MudGrid>
	</MudTabPanel>
	<MudTabPanel Text="Powiadomienia">
		<MudCard>
			<MudCardHeader>
				<CardHeaderContent>
					<MudText>Preferencje</MudText>
				</CardHeaderContent>
			</MudCardHeader>
			<MudCardContent>
				<MudGrid>
					<MudItem xs="12" sm="4">
						<MudText>
							<b>Email</b>
						</MudText>
						<MudText Typo="Typo.body2">
							What type of system notifications you want to recieve to your email.
						</MudText>
						<div class="d-flex flex-column mt-6">
							<MudCheckBox @bind-Value="@NotificationEmail_1" Label="Threat Detection" Color="Color.Primary"></MudCheckBox>
							<MudCheckBox @bind-Value="@NotificationEmail_2" Label="Server Errors" Color="Color.Error"></MudCheckBox>
							<MudCheckBox @bind-Value="@NotificationEmail_3" Label="Server Warnings" Color="Color.Warning"></MudCheckBox>
							<MudCheckBox @bind-Value="@NotificationEmail_4" Label="Spam" Color="Color.Success"></MudCheckBox>
						</div>
					</MudItem>
					<MudItem xs="12" sm="8">
						<MudText>
							<b>Chat</b>
						</MudText>
						<MudText Typo="Typo.body2">
							What type of system notifications you want to recieve in the phone application.
						</MudText>
						<div class="d-flex flex-column mt-6">
							<MudCheckBox @bind-Value="@NotificationChat_1" Label="Threat Detection" Color="Color.Primary"></MudCheckBox>
							<MudCheckBox @bind-Value="@NotificationChat_2" Label="Server Errors" Color="Color.Error"></MudCheckBox>
							<MudCheckBox @bind-Value="@NotificationChat_3" Label="Server Warnings" Color="Color.Warning"></MudCheckBox>
							<MudCheckBox @bind-Value="@NotificationChat_4" Label="Spam" Color="Color.Success"></MudCheckBox>
						</div>
					</MudItem>
				</MudGrid>
			</MudCardContent>
			<MudCardActions Class="pb-4 pl-4">
				<MudButton Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto" @onclick="@(() => SaveChanges("Notification settings saved", Severity.Success))">Save Changes</MudButton>
			</MudCardActions>
		</MudCard>
	</MudTabPanel>
	<MudTabPanel Text="Bezpieczeństwo">
		<MudForm @ref="form">
			<MudCard>
				<MudCardHeader>
					<CardHeaderContent>
						<MudText>Change Password</MudText>
					</CardHeaderContent>
				</MudCardHeader>
				<MudCardContent>
					<MudGrid>
						<MudItem xs="12" md="6">
							<MudTextField T="string" Label="Password" Variant="Variant.Outlined" InputType="InputType.Password" @ref="pwField1" Validation="@(new Func<string, IEnumerable<string>>(PasswordStrength))" Required="true" RequiredError="Password is required!" />
						</MudItem>
						<MudItem xs="12" md="6">
							<MudTextField T="string" Label="Password Confirmation" Variant="Variant.Outlined" InputType="InputType.Password" Validation="@(new Func<string, string>(PasswordMatch))" />
						</MudItem>
						<MudItem xs="12">
							<MudTextField T="string" Label="Current Password" Variant="Variant.Outlined" InputType="InputType.Password" />
						</MudItem>
					</MudGrid>
				</MudCardContent>
				<MudCardActions Class="pb-4 pl-4">
					<MudButton Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto" @onclick="@(() => SaveChanges("Current Password is incorrect", Severity.Error))">Change Password</MudButton>
				</MudCardActions>
			</MudCard>
		</MudForm>
	</MudTabPanel>
</MudTabs>

